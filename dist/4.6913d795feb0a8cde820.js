webpackJsonp([4],{"./js/screens/reset/actions.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchReset=t.attemptPasswordReset=void 0;var s=n("./js/containers/app/actions.js"),o=n("../service/service.js"),r=n("./js/screens/reset/constants.js"),i=n("./js/services/ApiService/index.js"),a=(t.attemptPasswordReset=function(e){return function(t){t(u({isAttemptingReset:!0})),(0,i.sendRequest)({endpoint:"http://localhost:3333/api/v1/auth/forgotPassword",method:"POST",payload:JSON.stringify(e)}).then(function(e){void 0!==e?(void 0!==e.messages&&(t(d({notice:e.messages[0].message})),setTimeout(function(){t(u({isAttemptingReset:!1}))},1e3)),void 0!==e.data&&(t(c({email:e.data.user[0].email})),t(l({isResetStatusModalOpen:!0})))):setTimeout(function(){t(u({isAttemptingReset:!1}))},1e3)}).catch(function(e){return console.log(e)})}},t.fetchReset=function(e){return function(t){return t((0,s.isLoading)(!0)),(0,o.getPageData)(e).then(function(e){return t((0,s.setMeta)(e.meta)),t((0,s.setUrl)(e.url)),t((0,s.setTitle)(e.title)),e}).then(function(e){t((0,s.isLoading)(!1)),t(a(e))}).catch(function(e){throw console.error(e),e})}},function(e){return{type:r.SET_RESET,data:e}}),l=function(e){return{type:r.SET_RESET_MODAL_STATUS,data:e}},u=function(e){return{type:r.SET_RESET_ATTEMPTING_STATUS,data:e}},c=function(e){return{type:r.SET_RECOVERY_EMAIL,data:e}},d=function(e){return{type:r.SET_RECOVERY_NOTICE,data:e}}},"./js/screens/reset/index.js":function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),l=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  background: #f5f5f5;\n  width: 100%;\n  height: 100vh;\n  border-radius: 4px;\n  display: flex;\n"],["\n  background: #f5f5f5;\n  width: 100%;\n  height: 100vh;\n  border-radius: 4px;\n  display: flex;\n"]),u=n("../node_modules/react/index.js"),c=s(u),d=n("../node_modules/prop-types/index.js"),f=(s(d),n("../node_modules/react-redux/es/index.js")),p=n("../node_modules/react-spinners/index.js"),m=n("./js/redux/reducerInjector.js"),h=s(m),y=n("../node_modules/react-router-dom/es/index.js"),b=(n("./js/containers/app/reducer.js"),n("./js/containers/header/actions.js")),j=n("./js/containers/footer/actions.js"),E=n("./js/screens/reset/actions.js"),g=n("./js/screens/reset/constants.js"),v=n("./js/screens/reset/reducer.js"),x=n("../node_modules/pcln-design-system/dist/index.js"),R=n("./js/components/UI/atoms/index.js"),S=n("../node_modules/styled-components/dist/styled-components.browser.es.js"),_=s(S),T=n("../node_modules/react-pose/lib/index.js"),w=s(T),O=(n("../node_modules/popmotion/dist/popmotion.es.js"),w.default.div({fullscreen:{scale:1,transition:"tween"},idle:{scale:0,transition:"tween"}})),P=(0,_.default)(O)(l),k=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={uid:""},n.handleResetSubmit=n.handleResetSubmit.bind(n),n.navigateToLocation=n.navigateToLocation.bind(n),n}return i(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.setHeaderVisibility,n=e.setFooterVisibility,s=e.onLoadReset,o=e.match;setTimeout(function(){t({isHeaderVisible:!1}),n({isFooterVisible:!1})},200),s(o.path)}},{key:"render",value:function(){var e=this;return c.default.createElement(x.Flex,{style:{height:"100%"}},c.default.createElement(P,{pose:this.props.reset.isResetStatusModalOpen?"fullscreen":"idle",style:{display:this.props.reset.isResetStatusModalOpen?"block":"none"}},c.default.createElement(x.Flex,{p:3,flexDirection:"column",justify:"center",alignItems:"center",style:{height:"100%"}},c.default.createElement(x.Box,{mb:2},c.default.createElement(x.Text,{align:"center",fontSize:3,bold:!0},"Password Reset Link Sent."),c.default.createElement(x.Text.p,{align:"center",fontSize:3},"We've sent a password reset link to your email.")),c.default.createElement(x.Flex,{justify:"center",mb:3},c.default.createElement(R.Button,{onClick:function(t){return e.openMailHost()}},"See it in your inbox")),c.default.createElement(x.Flex,{justify:"center"},c.default.createElement(x.Link,{onClick:function(t){return e.props.history.push("/login")}},c.default.createElement(x.Flex,null,c.default.createElement(x.Icon,{name:"chevronLeft",style:{marginTop:"4px"},size:12,mr:1}),c.default.createElement(x.Text,{fontSize:1,style:{textDecoration:"underline"}},"Return back to login")))))),c.default.createElement(x.Flex,{px:3,flexDirection:"column",justifyContent:"center",alignItems:"center",style:{position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)",display:this.props.reset.isResetStatusModalOpen?"none":"block"},width:[1,.9,.7]},c.default.createElement("form",{method:"get",onSubmit:function(t){t.preventDefault(),e.handleResetSubmit()}},c.default.createElement(x.Flex,{flexDirection:"column",justify:"center",alignItems:"center"},c.default.createElement(x.Flex,{mb:3,alignItems:"center",justify:"center"},c.default.createElement(R.BrandLogo,{height:"45px",color:"red"})),c.default.createElement(x.Box,{mb:this.props.reset.recoveryNotice.length>0?1:3},c.default.createElement(R.Label,{mb:1,fontSize:0},"Email or Username"),c.default.createElement(R.Input,{onChange:function(t){return e.setState({uid:t.target.value})},value:this.state.uid,id:"username",autoFocus:!0})),void 0!==this.props.reset.recoveryNotice&&this.props.reset.recoveryNotice.length>0&&c.default.createElement(x.Box,{mb:2},c.default.createElement(x.Text,{fontSize:1,align:"right",color:"red"},this.props.reset.recoveryNotice)),c.default.createElement(x.Box,null,c.default.createElement(R.Button,{disabled:this.props.reset.isAttemptingReset||!this.isValidForm(),fullWidth:!0},this.props.reset.isAttemptingReset?c.default.createElement(p.SyncLoader,{color:"#f1f1f1",size:10,loading:!0}):c.default.createElement(x.Text,null,"Reset My Password")))))))}},{key:"openMailHost",value:function(){var e=this.props.reset.recoveryEmail,t=e.split("@")[1];window.open("https://"+t)}},{key:"handleResetSubmit",value:function(){var e=this.state.uid;this.props.attemptPasswordReset({uid:e})}},{key:"navigateToLocation",value:function(e){this.props.history.push(e)}},{key:"isValidForm",value:function(){return this.state.uid.length>1}}]),t}(c.default.PureComponent),M=function(e){return{reset:(0,v.getResetState)(e).toJS()}},F=function(e){return{onLoadReset:function(t){return e((0,E.fetchReset)(t))},attemptPasswordReset:function(t){return e((0,E.attemptPasswordReset)(t))},setHeaderVisibility:function(t){return e((0,b.setHeaderVisibility)(t))},setFooterVisibility:function(t){return e((0,j.setFooterVisibility)(t))}}},L=(0,h.default)(g.REDUCER_NAME,v.resetReducer)(k);t.default=(0,y.withRouter)((0,f.connect)(M,F)(L))}});